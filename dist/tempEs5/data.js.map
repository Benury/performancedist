{"version":3,"sources":["../tempCollect/data.js"],"names":["isValid","data","resources","marks","measures","perfTiming","allResourcesCalc","supportsFeatures","window","performance","getEntriesByType","undefined","webkitGetEntriesByType","alert","timing","loadEventEnd","navigationStart","filter","currR","name","match","map","i","arr","isRequest","indexOf","urlFragments","maybeFileName","fileExtension","split","pop","substr","Math","max","lastIndexOf","Infinity","location","host","currRes","domain","initiatorType","loadtime","duration","fileType","helper","getFileType","isRequestToHost","attr","requestStart","requestStartDelay","startTime","dns","domainLookupEnd","domainLookupStart","tcp","connectEnd","connectStart","ttfb","responseStart","requestDuration","secureConnectionStart","ssl","requestsOnly","initiatorTypeCounts","getItemCount","initiatorTypeCountHostExt","requestsByDomain","fileTypeCountHostExt","fileTypeCounts","tempResponseEnd","forEach","entry","a","lastResponseEnd","responseEnd","durationTotalParallel","durationTotal","hostRequests","length","currAndSubdomainRequests","slice","join","crossDocDomainRequests","endsWith","document","hostSubdomains","slowestCalls","average","href","sort","b","floor","reduceRight"],"mappings":"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","sourcesContent":["import helper from \"./helpers/helpers\";\r\n\r\nlet isValid = true;\r\n\r\nconst data = {\r\n\tresources: [],\r\n\tmarks: [],\r\n\tmeasures: [],\r\n\tperfTiming: [],\r\n\tallResourcesCalc: [],\r\n\tisValid : () => isValid\r\n};\r\n\r\nconst supportsFeatures = () => {\r\n\t//Check if the browser suppots the timing APIs\r\n\tif(window.performance && window.performance.getEntriesByType !== undefined) {\r\n\t\tdata.resources = window.performance.getEntriesByType(\"resource\");\r\n\t\tdata.marks = window.performance.getEntriesByType(\"mark\");\r\n\t\tdata.measures = window.performance.getEntriesByType(\"measure\");\r\n\t}else if(window.performance && window.performance.webkitGetEntriesByType !== undefined) {\r\n\t\tdata.resources = window.performance.webkitGetEntriesByType(\"resource\");\r\n\t\tdata.marks = window.performance.webkitGetEntriesByType(\"mark\");\r\n\t\tdata.measures = window.performance.webkitGetEntriesByType(\"measure\");\r\n\t}else{\r\n\t\talert(\"Oups, looks like this browser does not support the Resource Timing API\\ncheck http://caniuse.com/#feat=resource-timing to see the ones supporting it \\n\\n\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif(window.performance.timing){\r\n\t\tdata.perfTiming = window.performance.timing;\r\n\t}else{\r\n\t\talert(\"Oups, looks like this browser does not support performance timing\");\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif(data.perfTiming.loadEventEnd - data.perfTiming.navigationStart < 0){\r\n\t\talert(\"Page is still loading - please try again when page is loaded.\");\r\n\t\treturn false;\r\n\t}\r\n\treturn true;\r\n};\r\n\r\n(() =>  {\r\n\r\n\tisValid = supportsFeatures();\r\n\r\n\r\n\tdata.allResourcesCalc = data.resources\r\n\t\t//remove this bookmarklet from the result\r\n\t\t.filter((currR) => !currR.name.match(/http[s]?\\:\\/\\/(micmro|nurun).github.io\\/performance-bookmarklet\\/.*/))\r\n\t\t.map((currR, i, arr) => {\r\n\t\t\t//crunch the resources data into something easier to work with\r\n\t\t\tconst isRequest = currR.name.indexOf(\"http\") === 0;\r\n\t\t\tlet  urlFragments, maybeFileName, fileExtension;\r\n\r\n\t\t\tif(isRequest){\r\n\t\t\t\turlFragments = currR.name.match(/:\\/\\/(.[^/]+)([^?]*)\\??(.*)/);\r\n\t\t\t\tmaybeFileName = urlFragments[2].split(\"/\").pop();\r\n\t\t\t\tfileExtension = maybeFileName.substr((Math.max(0, maybeFileName.lastIndexOf(\".\")) || Infinity) + 1);\r\n\t\t\t}else{\r\n\t\t\t\turlFragments = [\"\", location.host];\r\n\t\t\t\tfileExtension = currR.name.split(\":\")[0];\r\n\t\t\t}\r\n\r\n\t\t\tconst currRes = {\r\n\t\t\t\tname : currR.name,\r\n\t\t\t\tdomain : urlFragments[1],\r\n\t\t\t\tinitiatorType : currR.initiatorType || fileExtension || \"SourceMap or Not Defined\",\r\n\t\t\t\tfileExtension : fileExtension || \"XHR or Not Defined\",\r\n\t\t\t\tloadtime : currR.duration,\r\n\t\t\t\tfileType : helper.getFileType(fileExtension, currR.initiatorType),\r\n\t\t\t\tisRequestToHost : urlFragments[1] === location.host\r\n\t\t\t};\r\n\r\n\t\t\tfor(let attr in currR){\r\n\t\t\t\tif(typeof currR[attr] !== \"function\") {\r\n\t\t\t\t\tcurrRes[attr] = currR[attr];\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(currR.requestStart){\r\n\t\t\t\tcurrRes.requestStartDelay = currR.requestStart - currR.startTime;\r\n\t\t\t\tcurrRes.dns = currR.domainLookupEnd - currR.domainLookupStart;\r\n\t\t\t\tcurrRes.tcp = currR.connectEnd - currR.connectStart;\r\n\t\t\t\tcurrRes.ttfb = currR.responseStart - currR.startTime;\r\n\t\t\t\tcurrRes.requestDuration = currR.responseStart - currR.requestStart;\r\n\t\t\t}\r\n\t\t\tif(currR.secureConnectionStart){\r\n\t\t\t\tcurrRes.ssl = currR.connectEnd - currR.secureConnectionStart;\r\n\t\t\t}\r\n\r\n\t\t\treturn currRes;\r\n\t\t});\r\n\r\n\t//filter out non-http[s] and sourcemaps\r\n\tdata.requestsOnly = data.allResourcesCalc.filter((currR) => {\r\n\t\treturn currR.name.indexOf(\"http\") === 0 && !currR.name.match(/js.map$/);\r\n\t});\r\n\r\n\r\n\t//get counts\r\n\tdata.initiatorTypeCounts = helper.getItemCount(data.requestsOnly.map((currR, i, arr) => {\r\n\t\treturn currR.initiatorType || currR.fileExtension;\r\n\t}), \"initiatorType\");\r\n\r\n\tdata.initiatorTypeCountHostExt = helper.getItemCount(data.requestsOnly.map((currR, i, arr) => {\r\n\t\treturn (currR.initiatorType  || currR.fileExtension) + \" \" + (currR.isRequestToHost ? \"(host)\" : \"(external)\");\r\n\t}), \"initiatorType\");\r\n\r\n\tdata.requestsByDomain = helper.getItemCount(data.requestsOnly.map((currR, i, arr) => currR.domain), \"domain\");\r\n\r\n\tdata.fileTypeCountHostExt = helper.getItemCount(data.requestsOnly.map((currR, i, arr) => {\r\n\t\treturn currR.fileType  + \" \" + (currR.isRequestToHost ? \"(host)\" : \"(external)\");\r\n\t}), \"fileType\");\r\n\r\n\tdata.fileTypeCounts = helper.getItemCount(data.requestsOnly.map((currR, i, arr) => currR.fileType), \"fileType\");\r\n\r\n\tconst tempResponseEnd = {};\r\n\t//TODO: make immutable\r\n\tdata.requestsOnly.forEach((currR) => {\r\n\t\tconst entry = data.requestsByDomain.filter((a) => a.domain == currR.domain)[0]||{};\r\n\r\n\t\tconst lastResponseEnd = tempResponseEnd[currR.domain]||0;\r\n\r\n\t\tcurrR.duration = entry.duration||(currR.responseEnd - currR.startTime);\r\n\r\n\t\tif(lastResponseEnd <= currR.startTime){\r\n\t\t\tentry.durationTotalParallel = (entry.durationTotalParallel||0) + currR.duration;\r\n\t\t} else if (lastResponseEnd < currR.responseEnd){\r\n\t\t\tentry.durationTotalParallel = (entry.durationTotalParallel||0) + (currR.responseEnd - lastResponseEnd);\r\n\t\t}\r\n\t\ttempResponseEnd[currR.domain] = currR.responseEnd||0;\r\n\t\tentry.durationTotal = (entry.durationTotal||0) + currR.duration;\r\n\t});\r\n\r\n\r\n\t//Request counts\r\n\tdata.hostRequests = data.requestsOnly\r\n\t\t.filter((domain) => domain.domain === location.host).length;\r\n\r\n\tdata.currAndSubdomainRequests = data.requestsOnly\r\n\t\t.filter((domain) => domain.domain.split(\".\").slice(-2).join(\".\") === location.host.split(\".\").slice(-2).join(\".\"))\r\n\t\t.length;\r\n\r\n\tdata.crossDocDomainRequests = data.requestsOnly\r\n\t\t.filter((domain) => !helper.endsWith(domain.domain, document.domain)).length;\r\n\r\n\tdata.hostSubdomains = data.requestsByDomain\r\n\t\t.filter((domain) => helper.endsWith(domain.domain, location.host.split(\".\").slice(-2).join(\".\")) && domain.domain !== location.host)\r\n\t\t.length;\r\n\r\n\r\n\tdata.slowestCalls = [];\r\n\tdata.average = undefined;\r\n\r\n\tif(data.allResourcesCalc.length > 0){\r\n\t\tdata.slowestCalls = data.allResourcesCalc\r\n\t\t\t.filter((a) => a.name !== location.href)\r\n\t\t\t.sort((a, b) => b.duration - a.duration);\r\n\r\n\t\tdata.average = Math.floor(data.slowestCalls.reduceRight((a,b) => {\r\n\t\t\tif(typeof a !== \"number\"){\r\n\t\t\t\treturn a.duration + b.duration\r\n\t\t\t}\r\n\t\t\treturn a + b.duration;\r\n\t\t}) / data.slowestCalls.length);\r\n\t}\r\n})();\r\n\r\nexport default data;\r\n"],"file":"data.js"}