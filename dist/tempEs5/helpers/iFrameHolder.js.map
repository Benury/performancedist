{"version":3,"sources":["../../tempCollect/helpers/iFrameHolder.js"],"names":["iFrameEl","outputHolder","outputContent","outputIFrame","initHolderEl","dom","newTag","id","window","closeBtn","text","addEventListener","parentNode","removeChild","appendChild","getElementById","firstChild","addComponent","domEl","getOutputIFrame","setup","onIFrameReady","document","finalize","body","getComputedStyle","overflow","style","height","clientHeight","contentWindow","onload","styleTag","type","head"],"mappings":"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","sourcesContent":["/*\r\niFrame and holder logic\r\n*/\r\nimport dom from \"../helpers/dom\";\r\nimport { style } from \"../helpers/style\";\r\n\r\n/**\r\n * iFrame to contain perf-bookmarklet's diagrams\r\n * @type {HTMLIFrameElement}\r\n */\r\nlet iFrameEl;\r\n\r\n/**\r\n * Holder element\r\n * @type {HTMLDivElement}\r\n */\r\nlet outputHolder;\r\n\r\n/** @type {HTMLDivElement}  */\r\nlet outputContent;\r\n\r\n/**\r\n * Holder document for perf-bookmarklet (in iFrame)\r\n * @type {Document}\r\n */\r\nlet outputIFrame;\r\n\r\n/** setup iFrame overlay */\r\nconst initHolderEl = () => {\r\n\t// find or create holder element\r\n\tif (!outputHolder) {\r\n\t\toutputHolder = dom.newTag(\"div\", { id: \"perfbook-holder\" });\r\n\t\toutputContent = dom.newTag(\"div\", { id: \"perfbook-content\" });\r\n\t\twindow.outputContent;\r\n\r\n\t\tconst closeBtn = dom.newTag(\"button\", {\r\n\t\t\tclass: \"perfbook-close\",\r\n\t\t\ttext: \"close\"\r\n\t\t});\r\n\t\tcloseBtn.addEventListener(\"click\", () => {\r\n\t\t\tiFrameEl.parentNode.removeChild(iFrameEl);\r\n\t\t});\r\n\r\n\t\toutputHolder.appendChild(closeBtn);\r\n\t\toutputHolder.appendChild(outputContent);\r\n\t} else {\r\n\t\toutputContent = outputIFrame.getElementById(\"perfbook-content\");\r\n\t\t//clear existing data\r\n\t\twhile (outputContent.firstChild) {\r\n\t\t\toutputContent.removeChild(outputContent.firstChild);\r\n\t\t}\r\n\t}\r\n};\r\n\r\nlet addComponent = (domEl) => {\r\n\tif(domEl) {\r\n\t\toutputContent.appendChild(domEl);\r\n\t}\r\n};\r\n\r\nlet getOutputIFrame = () => {\r\n\treturn outputIFrame\r\n}\r\n\r\nexport default  {\r\n\t/**\r\n\t * @param  {function} onIFrameReady\r\n\t */\r\n\tsetup: (onIFrameReady) => {\r\n\r\n\t\tiFrameEl = document.getElementById(\"perfbook-iframe\");\r\n\r\n\t\tconst finalize = () => {\r\n\t\t\tinitHolderEl();\r\n\t\t\tonIFrameReady(addComponent);\r\n\t\t\toutputIFrame.body.appendChild(outputHolder);\r\n\t\t\tif (getComputedStyle(document.body).overflow != \"hidden\") {\r\n\t\t\t\tiFrameEl.style.height = (outputHolder.clientHeight + 36) + \"px\";\r\n\t\t\t} else {\r\n\t\t\t\tiFrameEl.style.height = \"100%\";\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif (iFrameEl) {\r\n\t\t\toutputIFrame = iFrameEl.contentWindow.document;\r\n\t\t\toutputHolder = outputIFrame.getElementById(\"perfbook-holder\");\r\n\r\n\t\t\tinitHolderEl();\r\n\r\n\t\t\tonIFrameReady(addComponent);\r\n\r\n\t\t\tfinalize();\r\n\t\t} else {\r\n\t\t\tiFrameEl = dom.newTag(\"iframe\", {\r\n\t\t\t\tid: \"perfbook-iframe\",\r\n\t\t\t\tonload: () => {\r\n\t\t\t\t\toutputIFrame = iFrameEl.contentWindow.document;\r\n\r\n\t\t\t\t\t//add style to iFrame\r\n\t\t\t\t\tconst styleTag = dom.newTag(\"style\", {\r\n\t\t\t\t\t\ttype: \"text/css\",\r\n\t\t\t\t\t\ttext: style\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\toutputIFrame.head.appendChild(styleTag);\r\n\t\t\t\t\tfinalize();\r\n\t\t\t\t}\r\n\t\t\t}, \"position:absolute; top:1%; right:1%; margin-bottom:1em; left:1%; z-index:6543210; width:98%; border:0; box-shadow:0 0 25px 0 rgba(0,0,0,0.5); background:#fff;\");\r\n\t\t\tdocument.body.appendChild(iFrameEl);\r\n\t\t}\r\n\t},\r\n\tgetOutputIFrame: getOutputIFrame\r\n}\r\n"],"file":"iFrameHolder.js"}