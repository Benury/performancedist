{"version":3,"sources":["../../tempCollect/components/pieChart.js"],"names":["pieChartComponent","init","chartsHolder","dom","newTag","setupChart","title","chartData","countTexts","columns","id","chartHolder","appendChild","text","pieChartHelpers","createPieChart","data","requestsOnly","length","forEach","countText","createChartTable","requestsUnit","colourRangeR","colourRangeG","colourRangeB","requestsByDomainData","requestsByDomain","map","sourceDomain","domain","helper","clone","perc","count","label","location","host","colour","split","slice","join","getRandomColor","replace","durationAverage","Math","round","durationTotal","durationTotalParallel","name","field","initiatorTypeCounts","initiatorType","getInitiatorOrFileTypeColour","initiatorTypeCountHostExt","initiatorype","typeSegments","hostRequests","fileTypeCounts","fileType","fileTypeCountHostExt"],"mappings":"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","sourcesContent":["/*\r\nLogic for Request analysis pie charts\r\n*/\r\n\r\nimport data from \"../data\";\r\nimport helper from \"../helpers/helpers\";\r\nimport dom from \"../helpers/dom\";\r\nimport pieChartHelpers from \"../helpers/pieChartHelpers\";\r\n\r\nconst pieChartComponent = {};\r\n\r\npieChartComponent.init = () => {\r\n\r\n\tconst chartsHolder = dom.newTag(\"div\", {\r\n\t\tclass : \"pie-charts-holder chart-holder\"\r\n\t});\r\n\r\n\t// create a chart and table section\r\n\tconst setupChart = (title, chartData, countTexts, columns, id) => {\r\n\t\tconst chartHolder = dom.newTag(\"div\", {\r\n\t\t\tclass : \"pie-chart-holder\",\r\n\t\t\tid : id||\"\"\r\n\t\t});\r\n\t\tchartHolder.appendChild(dom.newTag(\"h1\", {text : title}));\r\n\t\tchartHolder.appendChild(pieChartHelpers.createPieChart(chartData, 400));\r\n\t\tchartHolder.appendChild(dom.newTag(\"p\", {text : \"Total Requests: \" + data.requestsOnly.length}));\r\n\t\tif(countTexts && countTexts.length){\r\n\t\t\tcountTexts.forEach((countText) => {\r\n\t\t\t\tchartHolder.appendChild(dom.newTag(\"p\", {text : countText}, \"margin-top:-1em\"));\r\n\t\t\t})\r\n\t\t}\r\n\t\tchartHolder.appendChild(pieChartHelpers.createChartTable(title, chartData, columns));\r\n\t\tchartsHolder.appendChild(chartHolder);\r\n\t};\r\n\r\n\r\n\t// init data for charts\r\n\r\n\tconst requestsUnit = data.requestsOnly.length / 100;\r\n\tconst colourRangeR = \"789abcdef\";\r\n\tconst colourRangeG = \"789abcdef\";\r\n\tconst colourRangeB = \"789abcdef\";\r\n\r\n\r\n\t//argument data\r\n\tconst requestsByDomainData = data.requestsByDomain.map((sourceDomain) => {\r\n\t\tconst domain = helper.clone(sourceDomain);\r\n\t\tdomain.perc = domain.count / requestsUnit;\r\n\t\tdomain.label = domain.domain;\r\n\t\tif(domain.domain === location.host){\r\n\t\t\tdomain.colour = \"#0c0\";\r\n\t\t}else if(domain.domain.split(\".\").slice(-2).join(\".\") === location.host.split(\".\").slice(-2).join(\".\")){\r\n\t\t\tdomain.colour = \"#0a0\";\r\n\t\t}else{\r\n\t\t\tdomain.colour = helper.getRandomColor(\"56789abcdef\", \"01234567\", \"abcdef\");\r\n\t\t}\r\n\t\tdomain.id = \"reqByDomain-\" + domain.label.replace(/[^a-zA-Z]/g, \"-\");\r\n\t\tdomain.durationAverage =  Math.round(domain.durationTotal / domain.count);\r\n\t\tdomain.durationTotal =  Math.round(domain.durationTotal);\r\n\t\tdomain.durationTotalParallel =  Math.round(domain.durationTotalParallel);\r\n\t\treturn domain;\r\n\t});\r\n\r\n\tsetupChart(\"Requests by Domain\", requestsByDomainData, [\r\n\t\t\"Domains Total: \" + data.requestsByDomain.length\r\n\t], [\r\n\t\t{name:\"Requests\", field: \"count\"},\r\n\t\t{name: \"Avg. Duration (ms)\", field: \"durationAverage\"},\r\n\t\t{name: \"Duration Parallel (ms)\", field: \"durationTotalParallel\"},\r\n\t\t{name: \"Duration Sum (ms)\", field: \"durationTotal\"}\r\n\t], \"pie-request-by-domain\");\r\n\r\n\tsetupChart(\"Requests by Initiator Type\", data.initiatorTypeCounts.map((initiatorType) => {\r\n\t\tinitiatorType.perc = initiatorType.count / requestsUnit;\r\n\t\tinitiatorType.label = initiatorType.initiatorType;\r\n\t\tinitiatorType.colour = helper.getInitiatorOrFileTypeColour((initiatorType.initiatorType), helper.getRandomColor(colourRangeR, colourRangeG, colourRangeB));\r\n\t\tinitiatorType.id = \"reqByInitiatorType-\" + initiatorType.label.replace(/[^a-zA-Z]/g, \"-\");\r\n\t\treturn initiatorType;\r\n\t}));\r\n\r\n\tsetupChart(\"Requests by Initiator Type (host/external domain)\", data.initiatorTypeCountHostExt.map((initiatorype) => {\r\n\t\tconst typeSegments = initiatorype.initiatorType.split(\" \");\r\n\t\tinitiatorype.perc = initiatorype.count / requestsUnit;\r\n\t\tinitiatorype.label = initiatorype.initiatorType;\r\n\t\tinitiatorype.colour = helper.getInitiatorOrFileTypeColour(typeSegments[0], helper.getRandomColor(colourRangeR, colourRangeG, colourRangeB), typeSegments[1] !== \"(host)\");\r\n\t\tinitiatorype.id = \"reqByInitiatorTypeLocEx-\" + initiatorype.label.replace(/[^a-zA-Z]/g, \"-\");\r\n\t\treturn initiatorype;\r\n\t}),[\r\n\t\t\"Requests to Host: \" + data.hostRequests,\r\n\t\t\"Host: \" + location.host,\r\n\t]);\r\n\r\n\tsetupChart(\"Requests by File Type\", data.fileTypeCounts.map((fileType) => {\r\n\t\tfileType.perc = fileType.count / requestsUnit;\r\n\t\tfileType.label = fileType.fileType;\r\n\t\tfileType.colour = helper.getInitiatorOrFileTypeColour((fileType.fileType), helper.getRandomColor(colourRangeR, colourRangeG, colourRangeB));\r\n\t\tfileType.id = \"reqByFileType-\" + fileType.label.replace(/[^a-zA-Z]/g, \"-\");\r\n\t\treturn fileType;\r\n\t}));\r\n\r\n\tsetupChart(\"Requests by File Type (host/external domain)\", data.fileTypeCountHostExt.map((fileType) => {\r\n\t\tconst typeSegments = fileType.fileType.split(\" \");\r\n\t\tfileType.perc = fileType.count / requestsUnit;\r\n\t\tfileType.label = fileType.fileType;\r\n\t\tfileType.colour = helper.getInitiatorOrFileTypeColour(typeSegments[0], helper.getRandomColor(colourRangeR, colourRangeG, colourRangeB), typeSegments[1] !== \"(host)\");\r\n\t\tfileType.id = \"reqByFileType-\" + fileType.label.replace(/[^a-zA-Z]/g, \"-\");\r\n\t\treturn fileType;\r\n\t}),[\r\n\t\t\"Requests to Host: \" + data.hostRequests,\r\n\t\t\"Host: \" + location.host,\r\n\t]);\r\n\r\n\r\n\treturn chartsHolder;\r\n};\r\n\r\nexport default pieChartComponent;\r\n"],"file":"pieChart.js"}